## ржЖржЧрзЗ ржПржХ рж▓рж╛ржЗржирзЗ ржорзВрж▓ ржзрж╛рж░ржгрж╛

ЁЯСЙ **Indirect communication ржорж╛ржирзЗ**  
Process-ржЧрзБрж▓рзЛ ржПржХрзЗ ржЕржкрж░рзЗрж░ ржирж╛ржо ржирж╛ ржЬрзЗржирзЗ, ржПржХржЯрж┐ **ржорж╛ржЭржЦрж╛ржирзЗрж░ ржмрж╛ржХрзНрж╕ (mailbox / port)** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ message ржЖржжрж╛ржи-ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред

---

## Mailbox ржЖрж╕рж▓рзЗ ржХрзА? (рж╕ржмржЪрзЗржпрж╝рзЗ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)

Mailbox-ржХрзЗ рждрзБржорж┐ ржПржнрж╛ржмрзЗ ржнрж╛ржмрзЛ:

ЁЯУо **ржПржХржЯрж╛ ржЪрж┐ржарж┐рж░ ржмрж╛ржХрзНрж╕**

- ржпрзЗ ржХрзЗржЙ ржЪрж┐ржарж┐ ржлрзЗрж▓рждрзЗ ржкрж╛рж░рзЗ
    
- ржпрзЗ ржХрзЗржЙ ржЪрж┐ржарж┐ рждрзБрж▓рзЗ ржирж┐рждрзЗ ржкрж╛рж░рзЗ (ржирж┐ржпрж╝ржо ржЕржирзБржпрж╛ржпрж╝рзА)
    

Process-рж░рж╛:

- message = ржЪрж┐ржарж┐
    
- mailbox = ржЪрж┐ржарж┐рж░ ржмрж╛ржХрзНрж╕
    

Process тЖТ mailbox тЖТ process

ЁЯСЙ Process-рж░рж╛ **ржПржХрзЗ ржЕржкрж░ржХрзЗ ржЪрж┐ржирждрзЗ рж╣ржпрж╝ ржирж╛**, рж╢рзБржзрзБ mailbox-ржЯрж╛ ржЪрж┐ржирж▓рзЗржЗ ржЪрж▓рзЗред

---

## рж▓рзЗржЦрж╛рж░ ржкрзНрж░ржержо ржЕржВрж╢ рж╕рж╣ржЬ ржХрж░рзЗ

> тАЬmessages are sent to and received from mailboxes, or portsтАЭ

ржорж╛ржирзЗ:

- Message рж╕рж░рж╛рж╕рж░рж┐ process-ржП ржпрж╛ржпрж╝ ржирж╛
    
- ржЖржЧрзЗ mailbox-ржП ржЬржорж╛ рж╣ржпрж╝
    

---

### Mailbox-ржПрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп

- Mailbox ржПржХржЯрж╛ **object**
    
- Process message ржврзБржХрж╛рждрзЗ ржкрж╛рж░рзЗ
    
- Process message ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗ
    
- ржкрзНрж░рждрж┐ржЯрж┐ mailbox-ржПрж░ ржПржХржЯрж┐ **unique ID** ржерж╛ржХрзЗ
    

ржЙржжрж╛рж╣рж░ржг:

- POSIX message queue-рждрзЗ mailbox ржЪрзЗржирж╛ рж╣ржпрж╝ ржПржХржЯрж╛ **integer number** ржжрж┐ржпрж╝рзЗ
    

ржпрзЗржоржи:
```c
Mailbox A = 101
Mailbox B = 202
```

## send() / receive() ржПржЦрж╛ржирзЗ ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

ржПржЦрж╛ржирзЗ ржЖрж░ process-ржПрж░ ржирж╛ржо рж▓рж╛ржЧрзЗ ржирж╛ред
```c
send(A, message);    // mailbox A-рждрзЗ ржкрж╛ржарж╛ржУ
receive(A, message); // mailbox A ржерзЗржХрзЗ ржирж╛ржУ
```

ЁЯСЙ ржХрзЗ ржкрж╛ржарж╛рж▓рзЛ, ржХрзЗ ржирж┐рж▓тАФржПржЯрж╛ mailbox handle ржХрж░рзЗ

---

## ржХржЦржи ржжрзБржЗржЯрж╛ process ржХржерж╛ ржмрж▓рждрзЗ ржкрж╛рж░ржмрзЗ?

ЁЯСЙ **рж╢рж░рзНржд ржПржХржЯрж╛ржЗ:**

> ржжрзБржЗ process-ржПрж░ ржоржзрзНржпрзЗ ржЕржирзНрждржд ржПржХржЯрж┐ **shared mailbox** ржерж╛ржХрждрзЗ рж╣ржмрзЗ

рждрж╛рж░рж╛:

- ржПржХржЗ mailbox ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ тЖТ communicate ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ
    
- ржЖрж▓рж╛ржжрж╛ mailbox рж╣рж▓рзЗ тЖТ ржкрж╛рж░ржмрзЗ ржирж╛
    

---

## Communication link-ржПрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп (рж╕рж╣ржЬ ржнрж╛рж╖рж╛ржпрж╝)

### 1я╕ПтГг Link рждржЦржиржЗ рж╣ржмрзЗ ржпржЦржи mailbox shared

ржорж╛ржирзЗ:

- P1 ржЖрж░ P2 ржпржжрж┐ ржПржХржЗ mailbox ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ тЖТ link ржЖржЫрзЗ
    
- ржирж╛ ржХрж░рж▓рзЗ тЖТ link ржирзЗржЗ
    

---

### 2я╕ПтГг ржПржХ mailbox ржЕржирзЗржХ process ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗ

ржЖржЧрзЗрж░ direct communication-ржП:

- рзз link = рзи process
    

ржПржЦрж╛ржирзЗ:

- рзз mailbox = рзи, рзй, рззрзжржЯрж╛ process
    

ЁЯСЙ ржПржЯрж╛ ржЕржирзЗржХ ржмрзЗрж╢рж┐ flexible

---

### 3я╕ПтГг ржПржХ process-pair-ржПрж░ ржПржХрж╛ржзрж┐ржХ link ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ

ржорж╛ржирзЗ:

- P1 ржУ P2
    
- mailbox A ржжрж┐ржпрж╝рзЗ ржХржерж╛ ржмрж▓рждрзЗ ржкрж╛рж░рзЗ
    
- ржЖржмрж╛рж░ mailbox B ржжрж┐ржпрж╝рзЗржУ
    

ЁЯСЙ ржПржХрж╛ржзрж┐ржХ communication channel рж╕ржорзНржнржм

---

## ржПржЦржи ржЖрж╕рж▓ тАЬconfusionтАЭ ржЕржВрж╢ (ржЦрзБржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)

ржзрж░рж╛ ржпрж╛ржХ:

- P1, P2, P3 тЖТ рж╕ржмрж╛ржЗ mailbox A ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ
    
- P1 message ржкрж╛ржарж╛рж▓
    
- P2 ржЖрж░ P3 ржжрзБржЬржирзЗржЗ receive() ржбрж╛ржХрж▓
    

тЭУ **ржХрзЗ message ржкрж╛ржмрзЗ?**

---

### ржПрж░ ржЙрждрзНрждрж░: System-ржПрж░ policy ржЕржирзБржпрж╛ржпрж╝рзА

рж▓рзЗржЦржХ рждрж┐ржиржЯрж╛ рж╕ржорзНржнрж╛ржмржирж╛ ржмрж▓ржЫрзЗржи:

---

### ЁЯЕ░я╕П Option 1: Mailbox = рж╢рзБржзрзБ рзи process

ржорж╛ржирзЗ:

- ржПржХ mailbox ржПржХрж╕рж╛ржерзЗ рж╢рзБржзрзБ ржжрзБржЗ process-ржПрж░ ржЬржирзНржп
    
- рждрж╛рж╣рж▓рзЗ confusion ржирзЗржЗ
    

---

### ЁЯЕ▒я╕П Option 2: ржПржХрж╕рж╛ржерзЗ ржПржХржЬржиржЗ receive() ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ

ржорж╛ржирзЗ:

- P2 ржЖрж░ P3 ржПржХрж╕рж╛ржерзЗ receive() ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗ ржирж╛
    
- ржпрзЗржЗ ржЖржЧрзЗ ржЖрж╕ржмрзЗ, рж╕рзЗ ржкрж╛ржмрзЗ
    

---

### ЁЯЕ╛я╕П Option 3: OS ржирж┐ржЬрзЗрж░ ржорждрзЛ ржмрзЗржЫрзЗ ржирзЗржмрзЗ

ржорж╛ржирзЗ:

- OS ржарж┐ржХ ржХрж░ржмрзЗ P2 ржирж╛ P3 ржХрзЗ ржжрзЗржмрзЗ
    
- ржжрзБржЬржи ржПржХрж╕рж╛ржерзЗ ржкрж╛ржмрзЗ ржирж╛
    

OS ржмрзЗржЫрзЗ ржирж┐рждрзЗ ржкрж╛рж░рзЗ:

- Round-robin (ржПржХржмрж╛рж░ P2, ржкрж░рзЗрж░ржмрж╛рж░ P3)
    
- ржмрж╛ ржЕржирзНржп algorithm
    

ЁЯСЙ OS ржЪрж╛ржЗрж▓рзЗ sender-ржХрзЗ ржЬрж╛ржирж╛рждрзЗржУ ржкрж╛рж░рзЗ ржХрзЗ message ржкрзЗрж▓

---

## Mailbox ржХрж╛рж░ ржорж╛рж▓рж┐ржХ рж╣рждрзЗ ржкрж╛рж░рзЗ?

ржПржЦрж╛ржирзЗ ржжрзБржЗржЯрж╛ case:

---

## Case 1: Mailbox ржпржжрж┐ ржХрзЛржирзЛ process-ржПрж░ рж╣ржпрж╝

ржорж╛ржирзЗ:

- Mailbox process-ржПрж░ address space-ржПрж░ ржЕржВрж╢
    

### рждржЦржи:

- **Owner** тЖТ рж╢рзБржзрзБ receive ржХрж░рждрзЗ ржкрж╛рж░рзЗ
    
- **User** тЖТ рж╢рзБржзрзБ send ржХрж░рждрзЗ ржкрж╛рж░рзЗ
    

ЁЯСЙ Owner ржПржХржЬржиржЗ тЖТ confusion ржирзЗржЗ

тЭЧ ржпржжрж┐ owner process ржорж╛рж░рж╛ ржпрж╛ржпрж╝:

- mailbox-ржУ ржорзБржЫрзЗ ржпрж╛ржпрж╝
    
- ржХрзЗржЙ send ржХрж░рж▓рзЗ тЖТ error message ржкрж╛ржмрзЗ
    

---

## Case 2: Mailbox ржпржжрж┐ OS-ржПрж░ рж╣ржпрж╝ (рж╕ржмржЪрзЗржпрж╝рзЗ ржмрж╛рж╕рзНрждржмрж╕ржорзНржоржд)

ЁЯСЙ Linux / UNIX-ржП ржПржЯрж╛ржЗ ржмрзЗрж╢рж┐ ржмрзНржпржмрж╣рзГржд

ржПржЦрж╛ржирзЗ mailbox:

- ржХрзЛржирзЛ process-ржПрж░ рж╕рж╛ржерзЗ ржмрж╛ржБржзрж╛ ржирж╛
    
- ржЖрж▓рж╛ржжрж╛ ржХрж░рзЗ ржЕрж╕рзНрждрж┐рждрзНржм рж░рж╛ржЦрзЗ
    

---

### OS рждржЦржи ржХрзА ржХрзА рж╕рзБржмрж┐ржзрж╛ ржжрзЗржпрж╝?

Process ржкрж╛рж░ржмрзЗ:

- ржирждрзБржи mailbox ржмрж╛ржирж╛рждрзЗ
    
- mailbox ржжрж┐ржпрж╝рзЗ send / receive ржХрж░рждрзЗ
    
- mailbox delete ржХрж░рждрзЗ
    

---

### Ownership ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ?

- ржпрзЗ process mailbox ржмрж╛ржирж╛ржпрж╝ тЖТ рж╕рзЗ owner
    
- рж╢рзБрж░рзБрждрзЗ рж╢рзБржзрзБ owner receive ржХрж░рждрзЗ ржкрж╛рж░рзЗ
    
- ржкрж░рзЗ OS call ржжрж┐ржпрж╝рзЗ:
    
    - ржЕржирзНржп process-ржХрзЗ receive ржХрж░рж╛рж░ ржЕржзрж┐ржХрж╛рж░ ржжрзЗржУржпрж╝рж╛ ржпрж╛ржпрж╝
        

ЁЯСЙ ржлрж▓рзЗ:

- ржПржХ mailbox-ржПрж░ ржПржХрж╛ржзрж┐ржХ receiver рж╣рждрзЗ ржкрж╛рж░рзЗ
    

---

## ржПржХржжржо рж╕рж╣ржЬ рж╕рж╛рж░рж╛ржВрж╢ (Beginner takeaway)

- **Direct communication** = ржПржХрзЗ ржЕржкрж░рзЗрж░ ржирж╛ржо ржЬрж╛ржирж╛ рж▓рж╛ржЧрзЗ (ржЦрж╛рж░рж╛ржк scaling)
    
- **Indirect communication** = mailbox ржмрзНржпржмрж╣рж╛рж░ (ржнрж╛рж▓рзЛ design)
    
- Mailbox:
    
    - ржорж╛ржЭржЦрж╛ржирзЗрж░ buffer
        
    - flexible
        
    - scalable
        
    - real OS-ржП ржмрзЗрж╢рж┐ ржмрзНржпржмрж╣рж╛рж░ рж╣ржпрж╝